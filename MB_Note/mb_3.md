## 简单功能合集

如题

## 装备某件物品时增加属性点

><i style="color:aqua;">以下代码丢到简单触发器中,设置0延时</i>

<details> <summary>代码点我展开</summary>

```python
#配置部分(必填)
(assign,":max",63) #声明属性的上限
(assign,":which_arm","itm_godz_zlzt_low") #哪件装备
(assign,":which_attribute",ca_agility) #增加哪个属性 ca_agility是敏捷
(assign,":buff",70) #增加多少点
(assign,":which_slot_to_show_equipped", 2024),#用trp的2024号slot表示是否装备该物品 1是 0否
(assign,":which_slot_to_store_value_of_real_buff", 2025),#用trp的2025号slot存储实际获得的属性加成
#主体
(troop_get_slot, ":equipped", "trp_player", ":which_slot_to_show_equipped"), 
(try_begin),
    (neg|eq, ":equipped", 1),

    (troop_has_item_equipped, "trp_player", ":which_arm"),
    (troop_set_slot, "trp_player", ":which_slot_to_show_equipped", 1),

    (store_attribute_level, ":agility_cur", "trp_player", ":which_attribute"),
    (store_add,":agility_after", ":agility_cur", ":buff"),

    (assign,":real_buff",":buff")
    (try_begin),
        (ge, ":agility_after", ":max"),
        (store_sub,":real_buff", ":max", ":agility_cur"),
    (else_try),
        (store_sub,":real_buff", ":agility_after", ":agility_cur"),
    (try_end),

    (troop_set_slot, "trp_player", ":which_slot_to_store_value_of_real_buff", ":real_buff"),
    (troop_raise_attribute, "trp_player", ":which_attribute", ":real_buff"),
(else_try),
    (eq, ":equipped", 1),
    (neg|troop_has_item_equipped, "trp_player", ":which_arm"),
    (troop_set_slot, "trp_player", ":which_slot_to_show_equipped", 0),

    (troop_get_slot, ":get_real_buff", "trp_player", ":which_slot_to_store_value_of_real_buff"),

    (store_attribute_level, ":agility_now", "trp_player", ":which_attribute"),
    (store_sub,":get_real_buff", 0, ":get_real_buff"),

    (troop_raise_attribute, "trp_player", ":which_attribute", ":get_real_buff"),
    
(try_end),
```

</details>

## 添加书籍

><i style="color:aqua;">添加一本书籍,当玩家拥有时,增加多少点技能</i>

以潘德395为例,打开scripts,找到`game_get_skill_modifier_for_troop`这一行,拉出来反编译:

```python
(store_script_param, ":var_0", 1),
(store_script_param, ":var_1", 2),
(assign, ":var_2", 0),
(try_begin),
    (eq, ":var_1", 11),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_wound_treatment_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 1),
(else_try),
    (eq, ":var_1", 17),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_training_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 2),
(else_try),
    (eq, ":var_1", 10),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_surgery_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 1),
(try_end),
(set_trigger_result, ":var_2"),
```

仿着写就可以了

```python
(store_script_param, ":var_0", 1),
(store_script_param, ":var_1", 2),
(assign, ":var_2", 0),
(try_begin),
    (eq, ":var_1", 11),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_wound_treatment_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 1),
(else_try),
    (eq, ":var_1", 17),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_training_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 2),
(else_try),
    (eq, ":var_1", 10),
    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_surgery_reference"),
    (gt, reg0, 0),
    (val_add, ":var_2", 1),
#-------------------------仿写部分
(else_try),
    (eq, ":var_1", 17), #这里17是教练技能的ID,自行尝试其他技能

    (call_script, "script_get_troop_item_amount", ":var_0", "itm_book_id"), //填物品ID
    (gt, reg0, 0),
    #如果你的MOD没有封装get_troop_item_amount这个函数,请自行判断玩家背包是否有一个及以上该物品

    (val_add, ":var_2", 5), #具体提升多少点,这里5点教练
#--------------------------
(try_end),
(set_trigger_result, ":var_2"),
```

><i style="color:aqua;">编译成txt,覆盖回去即可,注意行数的变化</i>

## 全自动武器

原理就是检测攻击键是否按住,然后```add_missile```,射速由战场触发器的检测间隔控制.

源码 :

<details> <summary>代码点我展开</summary>

```python
    (game_key_is_down,gk_attack),
    (get_player_agent_no,":player"),
    (agent_get_wielded_item,":weapon_cur",":player",0),

    #(this_or_next|eq,":weapon_cur","itm_bow"), #设置需要连射的武器id
    #(this_or_next|eq,":weapon_cur","itm_pistol"), #设置需要连射的武器id
    #...
    (eq,":weapon_cur","itm_hunting_bow"), #设置需要连射的武器id

    (agent_get_ammo,":ammo",":player", 1),
    (gt,":ammo",0),

    (assign,":missile_id",0),
    (try_for_range, ":item_carry", 0, 4),
      (agent_get_item_slot, ":slot_item", ":player", ":item_carry"),
      (neq,":slot_item",-1)
      (item_get_type, ":slot_item_type", ":slot_item"),
      (item_get_type, ":weapon_cur_type", ":weapon_cur"),
      (try_begin),
        (eq,":weapon_cur_type",itp_type_bow),
        (eq, ":slot_item_type", itp_type_arrows), 
        (assign,":missile_id",":slot_item"),
      (else_try),
        (eq,":weapon_cur_type",itp_type_crossbow),
        (eq, ":slot_item_type", itp_type_bolts),
        (assign,":missile_id",":slot_item"),
      (else_try),
        (eq,":weapon_cur_type",itp_type_pistol),
        (eq, ":slot_item_type", itp_type_bullets),
        (assign,":missile_id",":slot_item"),
        #若是手枪或火枪 可以在此处添加烟雾和枪声
      (else_try),
        (eq,":weapon_cur_type",itp_type_musket),
        (eq, ":slot_item_type", itp_type_bullets),
        (assign,":missile_id",":slot_item"),
        #若是手枪或火枪 可以在此处添加烟雾和枪声
      (try_end),
    (try_end),

    (val_sub,":ammo",1),
    (agent_set_ammo,":player",":missile_id",":ammo"),

    (agent_get_horse, ":horse", ":player"),
    (agent_get_look_position, pos3, ":player"),
    (agent_get_position, pos4, ":player"),
    (position_copy_rotation, pos4, pos3),
    (try_begin),
        (eq, ":horse", -1),
        (position_move_z, pos4, 170),
    (else_try),
        (position_move_z, pos4, 270),
    (try_end),
    (set_fixed_point_multiplier, 100),
    (store_random_in_range, ":var_3", -35, 100),
    (position_rotate_x_floating, pos4, 9000),
    (position_rotate_y_floating, pos4, ":var_3"),
    (position_rotate_x_floating, pos4, -9000),
    (store_random_in_range, ":var_4", -35, 100),
    (position_rotate_x_floating, pos4, ":var_4"),

    (add_missile, ":player", 4, 13500, ":weapon_cur", 0, ":missile_id", 0),
```

</details>

```mission_templates.txt```中搜索```lead_your_men_to_battle```

可以看到如下代码:

```go
You_lead_your_men_to_battle. 

4 1 4160 0 16 12 0  
0 4160 0 16 0 0  
4 8320 0 16 12 0  
4 8320 0 16 0 0  
22 #这里的数字表示触发器总数量
0.200000 0.000000 0.000000  0  42 72 1 6 1700 1 1224979098644774912 1726 3 1224979098644774913 1224979098644774912 0 31 2 1224979098644774913 288230376151712292 1727 3 1224979098644774914 1224979098644774912 1 32 2 1224979098644774914 0 2133 2 1224979098644774915 0 6 3 1224979098644774916 0 4 1804 3 1224979098644774917 1224979098644774912 1224979098644774916 2147483679 2 1224979098644774917 -1 1570 2 1224979098644774918 1224979098644774917 1570 2 1224979098644774919 1224979098644774913 4 0 31 2 1224979098644774919 8 31 2 1224979098644774918 5 2133 2 1224979098644774915 1224979098644774917 5 0 31 2 1224979098644774919 9 31 2 1224979098644774918 6 2133 2 1224979098644774915 1224979098644774917 3 0 3 0 2106 2 1224979098644774914 1 1776 3 1224979098644774912 1224979098644774915 1224979098644774914 1714 2 1224979098644774920 1224979098644774912 1709 2 3 1224979098644774912 1710 2 4 1224979098644774912 718 2 4 3 4 0 31 2 1224979098644774920 -1 722 2 4 170 5 0 722 2 4 270 3 0 2124 1 100 2136 3 1224979098644774921 -35 100 738 2 4 9000 739 2 4 1224979098644774921 738 2 4 -9000 2136 3 1224979098644774922 -35 100 738 2 4 1224979098644774922 1829 7 1224979098644774912 4 13500 1224979098644774913 0 1224979098644774915 0 
-25.000000 0.000000 0.000000  0  15 2071 1 1224979098644774912 1 2 936748722493063549 1224979098644774912 2133 2 1224979098644774913 5000 1718 2 1224979098644774914 1224979098644774912 2171 2 1224979098644774915 1224979098644774914 2107 2 1224979098644774915 35 2105 2 1224979098644774913 1224979098644774915 2136 3 1224979098644774916 0 3000 2105 2 1224979098644774913 1224979098644774916 1716 2 1224979098644774917 1224979098644774912 1671 2 1224979098644774918 1224979098644774917 2121 3 1224979098644774919 1224979098644774918 70 2107 2 1224979098644774919 30 2105 2 1224979098644774913 1224979098644774919 505 3 1224979098644774912 16 1224979098644774913 
-25.000000 0.000000 0.000000  0  3 2071 1 1224979098644774912 1718 2 1224979098644774913 1224979098644774912 1 4 936748722493063580 1729382256910270468 1224979098644774912 1224979098644774913 

```

将上述代码注释行的数字加1,例如显示是```21```,则改为```22```,即添加一个触发器
接着将源码转成txt,粘贴到```22```下面,
并在前面加上```0.200000 0.000000 0.000000  0 行数```,
0.200000表示1秒钟射5次;0.000000表示延迟检测;0.000000表示间隔;0表示触发条件为空;行数在用MBCE转好后有显示,填上即可,

战场触发器中有多个```lead_your_men_to_battle```,请全部修改,不要漏掉.

## 自爆步兵

进场后提高移速,贴近敌人后自爆

<details> <summary>代码点我展开</summary>

```python
(assign,":blow_dmg",1000), #设置自爆伤害
(assign,":blow_trpid","trp_rhodok_blow"), #设置自爆兵种ID

(assign, ":distance_closest", 1000),
(try_for_agents, ":blow_agent"),
    (agent_is_alive, ":blow_agent"),
    (agent_is_human, ":blow_agent"),
    (agent_get_troop_id, ":tar_troop", ":blow_agent"),
    (eq, ":tar_troop", ":blow_trpid"),
    (agent_get_team, ":blow_team", ":blow_agent"), 
    (agent_get_position,pos2,":blow_agent"),
    (agent_set_speed_modifier, ":blow_agent", 300),

    (assign, ":blowed", 0),

    (try_for_agents, ":enemies"),
        (agent_is_alive, ":enemies"),
        (agent_is_human, ":enemies"),

        (agent_get_position, pos3, ":enemies"),
        (agent_get_team, ":enemies_team", ":enemies"),
        (teams_are_enemies, ":blow_team", ":enemies_team"),

        (get_distance_between_positions, ":distance_abs", pos2, pos3),
        (lt, ":distance_abs", ":distance_closest"),
        (agent_deliver_damage_to_agent, ":blow_agent", ":enemies", ":blow_dmg"),
        (assign, ":blowed", 1),
    (try_end),

    (eq, ":blowed", 1)
    (agent_play_sound, ":blow_agent", "snd_pistol_shot"),
    (particle_system_burst,"psys_pistol_smoke",pos2,55),
    (agent_deliver_damage_to_agent, ":blow_agent", ":blow_agent", 1000),
(try_end),
```

</details>

依旧是战场触发器,和上一个案例一样,不过自爆不用检测间隔很短,设置个两三秒都可以
比如```2.000000 0.000000 0.000000  0 行数```两秒检测一次

## 光环:移速BUFF(光写了 没测)

为一个兵种设置移速光环,在该兵种附近的友军会得到一个10秒的双倍移速BUFF.


<details> <summary>代码点我展开</summary>

```python
(assign,":aura_troop_id","trp_rhodok_blow"), #设置光环士兵ID

(assign, ":distance_closest", 3000),
(try_for_agents, ":need_speed_agent"),
    (agent_is_alive, ":need_speed_agent"),
    (agent_is_human, ":need_speed_agent"),
    
    (agent_get_party_id, ":need_speed_agent_party", ":need_speed_agent"), 
    (agent_get_position,pos2,":need_speed_agent"),

    (assign,":in_range",0),
    (try_for_agents, ":ally"),
        (eq, ":in_range", 0),

        (agent_get_troop_id, ":tar_troop", ":ally"),
        (eq, ":tar_troop", ":aura_troop_id"),
        (agent_is_alive, ":ally"),
        (agent_is_human, ":ally"),

        (agent_get_position, pos3, ":ally"),
        (agent_get_party_id,":ally_party",":ally"),
        (eq, ":need_speed_agent_party", ":ally_party"),

        (get_distance_between_positions, ":distance_abs", pos2, pos3),
        (lt, ":distance_abs", ":distance_closest"),

        (assign,":in_range",1),
    (try_end),

    (try_begin),
        (eq, ":in_range",1),
        (agent_set_speed_modifier, ":need_speed_agent", 200),
    (else_try),
        (eq, ":in_range",0),
        (agent_set_speed_modifier, ":need_speed_agent", 100),
    (try_end),
(try_end),
```

</details>

依旧是战场触发器,和上一个案例一样,请参照修改
注意设置触发器的检测间隔为10秒```10.000000 0.000000 0.000000  0 行数```

## 散弹 但是每一个弹头都是自瞄

散弹 但是每个弹头都是自瞄 并且会锁定不同的敌人

添加: 魔球 武器攻击触发器

<details> <summary>代码点我展开</summary>

```python
(assign,":bullets_num",30), #分裂数量 设置太多可能会卡
(assign,":max_range",10000), #自瞄响应的最大射程 单位 米
#-------------------------
(assign,":agent_slot_begin",1400), #起始槽位 不和其他slot起冲突时请勿修改
#-------------------------

(val_mul,":max_range",100),
(store_add,":agent_slot_end",":agent_slot_begin",":bullets_num"), 

(store_trigger_param_1, ":user"),
(set_fixed_point_multiplier, 10000),
(agent_get_ammo, reg0, ":user", 1),
(agent_get_slot, ":var_1", ":user", 176),
(neg|eq, ":var_1", reg0),
(agent_set_slot, ":user", 176, reg0),
(2076, 42, ":user", 9, 1),
(agent_get_team, ":user_team", ":user"),

#
(try_for_range,":times",0,":bullets_num"),
    (try_begin),
        (assign, ":max_range_calc", ":max_range"), 
        (try_for_agents, ":enemies"),
            (assign,":break_1",0),
            (try_for_range,":slot_no",":agent_slot_begin",":agent_slot_end"),
                (agent_get_slot,":enemies_id", ":user", ":slot_no"),
                (eq, ":enemies_id", ":enemies"),
                (assign,":break_1",1),
            (try_end),

            (eq, ":break_1", 0),

            (agent_is_alive, ":enemies"),
            (agent_is_human, ":enemies"),
            (agent_get_team, ":enemy_team", ":enemies"),
            (teams_are_enemies, ":user_team", ":enemy_team"),
            (2076, 0, ":enemies", 9, 1),
            (position_has_line_of_sight_to_position, pos42, pos0),
            (get_distance_between_positions, ":distance_abs", pos0, pos42),

            (lt, ":distance_abs", ":max_range_calc"),
            (assign, ":max_range_calc", ":distance_abs"),
            
            (store_add,":cur_slot",":agent_slot_begin",":times"),
            (agent_set_slot, ":user", ":cur_slot", ":enemies"),
        (try_end),
    (try_end),
(try_end),
#
(try_begin),
    (agent_slot_eq,":user", ":agent_slot_begin", -1),
    (assign, ":tar_enemy", 1),
    (agent_get_look_position, pos0, ":user"),
    (position_copy_rotation, pos42, pos0),
(try_end),
#
(try_for_range,":slot_no",":agent_slot_begin",":agent_slot_end"),
    (agent_get_slot,":enemies_id", ":user", ":slot_no"),
    (neq, ":enemies_id", -1),
    (neq, ":enemies_id", 0),
    (assign,":tar_enemy",":enemies_id"),
    (2076, 0, ":enemies_id", 9, 1),

    (try_begin),
        (agent_slot_eq, ":user", 171, 0),
        (agent_get_troop_id, ":var_8", ":user"),
        (agent_get_horse, ":var_9", ":user"),
        (agent_get_wielded_item, ":var_10", ":user"),
        (assign, ":var_11", 10000),
        (assign, ":var_12", 10),
        (2702, ":var_13", ":var_10"),
        (val_add, ":var_13", 4),
        (assign, ":var_14", 4),
        (try_for_range, ":var_15", 0, ":var_14"),
            (troop_get_inventory_slot, ":var_16", ":var_8", ":var_15"),
            (eq, ":var_16", ":var_10"),
            (try_begin),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 17),
                (val_add, ":var_13", 4),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 19),
                (val_add, ":var_13", 2),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 18),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 32),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 33),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 35),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 36),
                (val_add, ":var_13", 2),
            (try_end),
            (assign, ":var_14", 0),
        (try_end),
        (val_min, ":var_12", ":var_13"),
        (try_begin),
            (eq, ":var_12", 1),
            (assign, ":var_11", 10580),
        (else_try),
            (eq, ":var_12", 2),
            (assign, ":var_11", 11137),
        (else_try),
            (eq, ":var_12", 3),
            (assign, ":var_11", 11663),
        (else_try),
            (eq, ":var_12", 4),
            (assign, ":var_11", 12166),
        (else_try),
            (eq, ":var_12", 5),
            (assign, ":var_11", 12649),
        (else_try),
            (eq, ":var_12", 6),
            (assign, ":var_11", 13115),
        (else_try),
            (eq, ":var_12", 7),
            (assign, ":var_11", 13567),
        (else_try),
            (eq, ":var_12", 8),
            (assign, ":var_11", 13997),
        (else_try),
            (eq, ":var_12", 9),
            (assign, ":var_11", 14425),
        (else_try),
            (eq, ":var_12", 10),
            (assign, ":var_11", 14834),
        (else_try),
            (eq, ":var_12", 11),
            (assign, ":var_11", 15237),
        (else_try),
            (eq, ":var_12", 12),
            (assign, ":var_11", 15613),
        (else_try),
            (eq, ":var_12", 13),
            (assign, ":var_11", 15992),
        (else_try),
            (eq, ":var_12", 14),
            (assign, ":var_11", 16364),
        (else_try),
            (eq, ":var_12", 15),
            (assign, ":var_11", 16730),
        (try_end),
        (2709, ":var_18", ":var_10"),
        (convert_to_fixed_point, ":var_18"),
        (val_mul, ":var_18", 120),
        (val_div, ":var_18", 100),
        (val_mul, ":var_18", ":var_11"),
        (convert_from_fixed_point, ":var_18"),
        (agent_set_slot, ":user", 175, ":var_18"),
        (try_for_range_backwards, ":var_19", 0, 4),
            (agent_get_item_slot, ":var_20", ":user", ":var_19"),
            (gt, ":var_20", 1),
            (item_get_type, ":var_21", ":var_20"),
            (try_begin),
                (eq, ":var_21", 9),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 8),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 16),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 6),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (else_try),
                (eq, ":var_21", 5),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (else_try),
                (eq, ":var_21", 18),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (try_end),
        (try_end),
    (try_end),
    (agent_get_slot, ":var_18", ":user", 175),
    (assign, ":var_25", 10000),
    (try_begin),
        (gt, ":var_9", 1),
        (assign, ":var_26", 10),
        (try_begin),
            (eq, ":var_26", 0),
            (assign, ":var_25", 8938),
        (else_try),
            (eq, ":var_26", 1),
            (assign, ":var_25", 9040),
        (else_try),
            (eq, ":var_26", 2),
            (assign, ":var_25", 9147),
        (else_try),
            (eq, ":var_26", 3),
            (assign, ":var_25", 9253),
        (else_try),
            (eq, ":var_26", 4),
            (assign, ":var_25", 9356),
        (else_try),
            (eq, ":var_26", 5),
            (assign, ":var_25", 9455),
        (else_try),
            (eq, ":var_26", 6),
            (assign, ":var_25", 9555),
        (else_try),
            (eq, ":var_26", 7),
            (assign, ":var_25", 9654),
        (else_try),
            (eq, ":var_26", 8),
            (assign, ":var_25", 9751),
        (else_try),
            (eq, ":var_26", 9),
            (assign, ":var_25", 9850),
        (else_try),
            (eq, ":var_26", 10),
            (assign, ":var_25", 9945),
        (try_end),
    (try_end),
    (val_mul, ":var_18", ":var_25"),
    (convert_from_fixed_point, ":var_18"),
    (try_begin),
        (gt, ":tar_enemy", 1),
        (agent_get_speed, pos0, ":tar_enemy"),
        (position_get_x, ":var_27", pos0),
        (position_get_y, ":var_28", pos0),
        (store_mul, ":var_1", ":var_27", ":var_27"),
        (convert_from_fixed_point, ":var_1"),
        (store_mul, ":var_29", ":var_28", ":var_28"),
        (convert_from_fixed_point, ":var_29"),
        (val_add, ":var_29", ":var_1"),
        (try_begin),
            (eq, ":var_27", 0),
            (assign, ":var_30", 0),
        (else_try),
            (assign, ":var_30", ":var_28"),
            (convert_to_fixed_point, ":var_30"),
            (val_div, ":var_30", ":var_27"),
            (store_atan, ":var_30", ":var_30"),
            (try_begin),
                (neg|ge, ":var_28", 0),
                (val_add, ":var_30", 1800000),
            (try_end),
            (val_sub, ":var_30", 900000),
        (try_end),
        (try_begin),
            (gt, ":var_29", 90000),
            (2076, 43, ":tar_enemy", 8, 1),
        (else_try),
            (2076, 43, ":tar_enemy", 9, 1),
        (try_end),
        (init_position, pos0),
        (position_copy_rotation, pos42, pos0),
        (position_copy_rotation, pos43, pos0),
        (position_move_z, pos43, 14, 1),
        (position_move_z, pos42, 14, 1),
        (try_begin),
            (gt, ":var_29", 0),
            (copy_position, pos41, pos43),
            (position_get_x, ":var_31", pos41),
            (position_get_y, ":var_32", pos41),
            (position_get_z, ":var_33", pos41),
            (position_get_x, ":var_34", pos42),
            (position_get_y, ":var_35", pos42),
            (position_get_z, ":var_36", pos42),
            (store_sub, ":var_37", ":var_33", ":var_36"),
            (store_sub, ":var_38", ":var_31", ":var_34"),
            (store_sub, ":var_39", ":var_32", ":var_35"),
            (store_mul, ":var_40", ":var_38", ":var_38"),
            (store_mul, ":var_41", ":var_39", ":var_39"),
            (store_add, ":var_42", ":var_40", ":var_41"),
            (store_mul, ":var_43", ":var_18", ":var_18"),
            (assign, ":var_44", 10),
            (convert_to_fixed_point, ":var_44"),
            (store_div, ":var_45", ":var_43", ":var_44"),
            (store_mul, ":var_46", ":var_45", ":var_45"),
            (store_mul, ":var_47", ":var_45", ":var_37"),
            (val_mul, ":var_47", 2),
            (store_sub, ":var_48", ":var_46", ":var_42"),
            (val_sub, ":var_48", ":var_47"),
            (try_begin),
                (gt, ":var_48", 0),
                (assign, ":var_1", 1),
                (convert_to_fixed_point, ":var_1"),
                (set_fixed_point_multiplier, 1),
                (store_sqrt, ":var_49", ":var_48"),
                (store_sub, ":var_50", ":var_45", ":var_49"),
                (val_sub, ":var_50", ":var_37"),
                (val_div, ":var_50", 100),
                (position_move_z, pos41, ":var_50", 1),
                (position_move_z, pos41, 4, 0),
                (set_fixed_point_multiplier, ":var_1"),
            (try_end),
            (copy_position, pos0, pos41),
            (position_get_z, ":var_1", pos42),
            (position_set_z, pos0, ":var_1"),
            (get_distance_between_positions, ":distance_abs", pos0, pos42),
            (position_transform_position_to_local, pos0, pos42, pos41),
            (position_get_z, ":var_37", pos0),
            (try_begin),
                (neg|ge, ":var_37", 0),
                (val_mul, ":var_37", 1),
            (try_end),
            (val_mul, ":var_37", 100),
            (val_div, ":var_37", ":distance_abs"),
            (store_atan, ":var_1", ":var_37"),
            (store_cos, ":var_1", ":var_1"),
            (store_mul, ":var_51", ":var_18", ":var_1"),
            (convert_from_fixed_point, ":var_51"),
            (copy_position, pos41, pos43),
            (position_transform_position_to_local, pos0, pos41, pos42),
            (position_get_x, ":var_38", pos0),
            (position_get_y, ":var_39", pos0),
            (try_begin),
                (eq, ":var_38", 0),
                (try_begin),
                    (eq, ":var_39", 0),
                    (assign, ":var_1", 0),
                (else_try),
                    (gt, ":var_39", 0),
                    (assign, ":var_1", 900000),
                (else_try),
                    (assign, ":var_1", 2700000),
                (try_end),
            (else_try),
                (convert_to_fixed_point, ":var_39"),
                (val_div, ":var_39", ":var_38"),
                (store_atan, ":var_1", ":var_39"),
                (try_begin),
                    (neg|ge, ":var_38", 0),
                    (val_add, ":var_1", 1800000),
                (try_end),
            (try_end),
            (val_add, ":var_1", 900000),
            (734, 41, ":var_1"),
            (store_mul, ":var_1", ":var_51", ":var_51"),
            (store_div, ":var_52", ":var_1", ":var_29"),
            (store_sub, ":var_53", ":var_52", 10000),
            (assign, ":var_54", ":distance_abs"),
            (convert_to_fixed_point, ":var_54"),
            (assign, ":var_1", ":var_54"),
            (convert_to_fixed_point, ":var_1"),
            (store_div, ":var_55", ":var_1", ":var_53"),
            (agent_get_position, pos2, ":tar_enemy"),
            (init_position, pos0),
            (position_copy_origin, pos2, pos41),
            (position_transform_position_to_local, pos2, pos41, pos2),
            (position_get_rotation_around_z, ":var_56", pos2),
            (convert_to_fixed_point, ":var_56"),
            (val_add, ":var_56", 900000),
            (val_add, ":var_56", ":var_30"),
            (try_begin),
                (store_cos, ":var_1", ":var_56"),
                (eq, ":var_1", 0),
                (assign, ":var_38", 0),
                (assign, ":var_39", 10000),
                (store_sqrt, ":var_1", ":var_52"),
                (val_add, ":var_39", ":var_1"),
                (try_begin),
                    (gt, ":var_56", 1800000),
                    (val_mul, ":var_39", 1),
                (try_end),
                (val_mul, ":var_39", ":var_55"),
                (convert_from_fixed_point, ":var_39"),
            (else_try),
                (store_tan, ":var_57", ":var_56"),
                (try_begin),
                    (neg|ge, ":var_57", 0),
                    (val_mul, ":var_57", 1),
                (try_end),
                (store_mul, ":var_58", ":var_57", ":var_57"),
                (convert_from_fixed_point, ":var_58"),
                (val_add, ":var_58", 10000),
                (assign, ":var_1", ":var_57"),
                (convert_to_fixed_point, ":var_1"),
                (store_div, ":var_59", ":var_1", ":var_58"),
                (val_mul, ":var_59", ":var_55"),
                (convert_from_fixed_point, ":var_59"),
                (assign, ":var_1", ":var_54"),
                (convert_to_fixed_point, ":var_1"),
                (store_div, ":var_60", ":var_1", ":var_58"),
                (store_mul, ":var_38", ":var_59", ":var_59"),
                (convert_from_fixed_point, ":var_38"),
                (store_mul, ":var_1", ":var_60", ":var_55"),
                (convert_from_fixed_point, ":var_1"),
                (val_add, ":var_38", ":var_1"),
                (store_sqrt, ":var_38", ":var_38"),
                (val_add, ":var_38", ":var_59"),
                (try_begin),
                    (gt, ":var_56", 900000),
                    (neg|ge, ":var_56", 2700000),
                    (val_mul, ":var_38", 1),
                (try_end),
                (store_mul, ":var_39", ":var_38", ":var_57"),
                (try_begin),
                    (neg|ge, ":var_28", 0),
                    (val_mul, ":var_39", 1),
                (try_end),
                (convert_from_fixed_point, ":var_39"),
            (try_end),
            (val_div, ":var_38", 100),
            (val_div, ":var_39", 100),
            (init_position, pos0),
            (position_set_x, pos0, ":var_38"),
            (position_set_y, pos0, ":var_39"),
            (position_transform_position_to_parent, pos41, pos41, pos0),
        (try_end),
        (try_begin),
            (neg|gt, ":var_29", 0),
            (copy_position, pos41, pos43),
        (try_end),
        (position_get_x, ":var_31", pos41),
        (position_get_y, ":var_32", pos41),
        (position_get_z, ":var_33", pos41),
        (position_get_x, ":var_34", pos42),
        (position_get_y, ":var_35", pos42),
        (position_get_z, ":var_36", pos42),
        (store_sub, ":var_37", ":var_33", ":var_36"),
        (store_sub, ":var_38", ":var_31", ":var_34"),
        (store_sub, ":var_39", ":var_32", ":var_35"),
        (store_mul, ":var_40", ":var_38", ":var_38"),
        (store_mul, ":var_41", ":var_39", ":var_39"),
        (store_add, ":var_42", ":var_40", ":var_41"),
        (store_mul, ":var_43", ":var_18", ":var_18"),
        (assign, ":var_44", 10),
        (convert_to_fixed_point, ":var_44"),
        (store_div, ":var_45", ":var_43", ":var_44"),
        (store_mul, ":var_46", ":var_45", ":var_45"),
        (store_mul, ":var_47", ":var_45", ":var_37"),
        (val_mul, ":var_47", 2),
        (store_sub, ":var_48", ":var_46", ":var_42"),
        (val_sub, ":var_48", ":var_47"),
        (try_begin),
            (gt, ":var_48", 0),
            (assign, ":var_1", 1),
            (convert_to_fixed_point, ":var_1"),
            (set_fixed_point_multiplier, 1),
            (store_sqrt, ":var_49", ":var_48"),
            (store_sub, ":var_50", ":var_45", ":var_49"),
            (val_sub, ":var_50", ":var_37"),
            (val_div, ":var_50", 100),
            (position_move_z, pos41, ":var_50", 1),
            (position_move_z, pos41, 4, 0),
            (set_fixed_point_multiplier, ":var_1"),
        (try_end),
        (position_transform_position_to_local, pos48, pos42, pos41),
        (position_get_y, ":var_39", pos48),
        (position_get_z, ":var_37", pos48),
        (try_begin),
            (eq, ":var_39", 0),
            (try_begin),
                (eq, ":var_37", 0),
                (assign, ":var_1", 0),
            (else_try),
                (ge, ":var_37", 0),
                (assign, ":var_1", 900000),
            (else_try),
                (assign, ":var_1", 2700000),
            (try_end),
        (else_try),
            (convert_to_fixed_point, ":var_37"),
            (val_div, ":var_37", ":var_39"),
            (store_atan, ":var_1", ":var_37"),
            (try_begin),
                (neg|ge, ":var_39", 0),
                (val_add, ":var_1", 1800000),
            (try_end),
        (try_end),
        (position_rotate_x_floating, pos42, ":var_1"),
        (position_transform_position_to_local, pos48, pos42, pos41),
        (position_get_y, ":var_39", pos48),
        (position_get_x, ":var_38", pos48),
        (try_begin),
            (eq, ":var_38", 0),
            (try_begin),
                (eq, ":var_39", 0),
                (assign, ":var_1", 0),
            (else_try),
                (ge, ":var_39", 0),
                (assign, ":var_1", 900000),
            (else_try),
                (assign, ":var_1", 2700000),
            (try_end),
        (else_try),
            (convert_to_fixed_point, ":var_39"),
            (val_div, ":var_39", ":var_38"),
            (store_atan, ":var_1", ":var_39"),
            (try_begin),
                (neg|ge, ":var_38", 0),
                (val_add, ":var_1", 1800000),
            (try_end),
        (try_end),
        (val_sub, ":var_1", 900000),
        (734, 42, ":var_1"),
    (try_end),
    (agent_get_slot, ":var_22", ":user", 172),
    (agent_get_slot, ":var_10", ":user", 174),
    (agent_get_slot, ":var_24", ":user", 171),
    (agent_get_slot, ":var_23", ":user", 173),
    (add_missile, ":user", 42, ":var_18", ":var_10", ":var_22", ":var_23", ":var_24"),

(try_end),

(try_for_range,":slot_no",":agent_slot_begin",":agent_slot_end"),
    (agent_set_slot,":user", ":slot_no", -1),
(try_end),
```

</details>

## 全自动远程射击

类似于尼尔机械纪元辅助机,会帮助玩家一直攻击目标
远程武器攻击触发,再次攻击或切换武器取消

1. 先给远程武器,比如弓箭,加一个武器攻击触发器:

```python
#将武器使用者的1398号slot当做开关,1开0关,用于控制远程武器自动射击
(store_trigger_param_1, ":user"),
(try_begin), 
    (neq|agent_slot_eq, ":user", 1398, 1),
    (agent_set_slot, ":user", 1398, 1),
(else_try),
    (agent_slot_eq, ":user", 1398, 1),
    (agent_set_slot, ":user", 1398, 0),
(try_end),
```

2. 自动瞄准的部分,这次我们把它封装到```scripts```中

<details> <summary>自瞄代码点我展开</summary>

```python
    #第一个参数是攻击方agent,第二个参数是目标敌人
    (store_script_param, ":user", 1),
    (store_script_param, ":enemyinslot", 2),
    #-----------
    (set_fixed_point_multiplier, 10000),

    (2076, 42, ":user", 9, 1),
    
    (assign,":tar_enemy",":enemyinslot"),
    (2076, 0, ":enemyinslot", 9, 1),

    (try_begin),
        (agent_slot_eq, ":user", 171, 0),
        (agent_get_troop_id, ":var_8", ":user"),
        (agent_get_horse, ":var_9", ":user"),
        (agent_get_wielded_item, ":var_10", ":user"),
        (assign, ":var_11", 10000),
        (assign, ":var_12", 10),
        (2702, ":var_13", ":var_10"),
        (val_add, ":var_13", 4),
        (assign, ":var_14", 4),
        (try_for_range, ":var_15", 0, ":var_14"),
            (troop_get_inventory_slot, ":var_16", ":var_8", ":var_15"),
            (eq, ":var_16", ":var_10"),
            (try_begin),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 17),
                (val_add, ":var_13", 4),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 19),
                (val_add, ":var_13", 2),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 18),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 32),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 33),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 35),
                (val_add, ":var_13", 1),
            (else_try),
                (troop_get_inventory_slot_modifier, ":var_17", ":var_8", ":var_15"),
                (eq, ":var_17", 36),
                (val_add, ":var_13", 2),
            (try_end),
            (assign, ":var_14", 0),
        (try_end),
        (val_min, ":var_12", ":var_13"),
        (try_begin),
            (eq, ":var_12", 1),
            (assign, ":var_11", 10580),
        (else_try),
            (eq, ":var_12", 2),
            (assign, ":var_11", 11137),
        (else_try),
            (eq, ":var_12", 3),
            (assign, ":var_11", 11663),
        (else_try),
            (eq, ":var_12", 4),
            (assign, ":var_11", 12166),
        (else_try),
            (eq, ":var_12", 5),
            (assign, ":var_11", 12649),
        (else_try),
            (eq, ":var_12", 6),
            (assign, ":var_11", 13115),
        (else_try),
            (eq, ":var_12", 7),
            (assign, ":var_11", 13567),
        (else_try),
            (eq, ":var_12", 8),
            (assign, ":var_11", 13997),
        (else_try),
            (eq, ":var_12", 9),
            (assign, ":var_11", 14425),
        (else_try),
            (eq, ":var_12", 10),
            (assign, ":var_11", 14834),
        (else_try),
            (eq, ":var_12", 11),
            (assign, ":var_11", 15237),
        (else_try),
            (eq, ":var_12", 12),
            (assign, ":var_11", 15613),
        (else_try),
            (eq, ":var_12", 13),
            (assign, ":var_11", 15992),
        (else_try),
            (eq, ":var_12", 14),
            (assign, ":var_11", 16364),
        (else_try),
            (eq, ":var_12", 15),
            (assign, ":var_11", 16730),
        (try_end),
        (2709, ":var_18", ":var_10"),
        (convert_to_fixed_point, ":var_18"),
        (val_mul, ":var_18", 120),
        (val_div, ":var_18", 100),
        (val_mul, ":var_18", ":var_11"),
        (convert_from_fixed_point, ":var_18"),
        (agent_set_slot, ":user", 175, ":var_18"),
        (try_for_range_backwards, ":var_19", 0, 4),
            (agent_get_item_slot, ":var_20", ":user", ":var_19"),
            (gt, ":var_20", 1),
            (item_get_type, ":var_21", ":var_20"),
            (try_begin),
                (eq, ":var_21", 9),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 8),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 16),
                (eq, ":var_20", ":var_10"),
                (troop_get_inventory_slot_modifier, ":var_22", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 172, ":var_22"),
                (agent_set_slot, ":user", 174, ":var_10"),
            (else_try),
                (eq, ":var_21", 6),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (else_try),
                (eq, ":var_21", 5),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (else_try),
                (eq, ":var_21", 18),
                (assign, ":var_23", ":var_20"),
                (troop_get_inventory_slot_modifier, ":var_24", ":var_8", ":var_19"),
                (agent_set_slot, ":user", 171, ":var_24"),
                (agent_set_slot, ":user", 173, ":var_23"),
            (try_end),
        (try_end),
    (try_end),
    (agent_get_slot, ":var_18", ":user", 175),
    (assign, ":var_25", 10000),
    (try_begin),
        (gt, ":var_9", 1),
        (assign, ":var_26", 10),
        (try_begin),
            (eq, ":var_26", 0),
            (assign, ":var_25", 8938),
        (else_try),
            (eq, ":var_26", 1),
            (assign, ":var_25", 9040),
        (else_try),
            (eq, ":var_26", 2),
            (assign, ":var_25", 9147),
        (else_try),
            (eq, ":var_26", 3),
            (assign, ":var_25", 9253),
        (else_try),
            (eq, ":var_26", 4),
            (assign, ":var_25", 9356),
        (else_try),
            (eq, ":var_26", 5),
            (assign, ":var_25", 9455),
        (else_try),
            (eq, ":var_26", 6),
            (assign, ":var_25", 9555),
        (else_try),
            (eq, ":var_26", 7),
            (assign, ":var_25", 9654),
        (else_try),
            (eq, ":var_26", 8),
            (assign, ":var_25", 9751),
        (else_try),
            (eq, ":var_26", 9),
            (assign, ":var_25", 9850),
        (else_try),
            (eq, ":var_26", 10),
            (assign, ":var_25", 9945),
        (try_end),
    (try_end),
    (val_mul, ":var_18", ":var_25"),
    (convert_from_fixed_point, ":var_18"),
    (try_begin),
        (gt, ":tar_enemy", 1),
        (agent_get_speed, pos0, ":tar_enemy"),
        (position_get_x, ":var_27", pos0),
        (position_get_y, ":var_28", pos0),
        (store_mul, ":var_1", ":var_27", ":var_27"),
        (convert_from_fixed_point, ":var_1"),
        (store_mul, ":var_29", ":var_28", ":var_28"),
        (convert_from_fixed_point, ":var_29"),
        (val_add, ":var_29", ":var_1"),
        (try_begin),
            (eq, ":var_27", 0),
            (assign, ":var_30", 0),
        (else_try),
            (assign, ":var_30", ":var_28"),
            (convert_to_fixed_point, ":var_30"),
            (val_div, ":var_30", ":var_27"),
            (store_atan, ":var_30", ":var_30"),
            (try_begin),
                (neg|ge, ":var_28", 0),
                (val_add, ":var_30", 1800000),
            (try_end),
            (val_sub, ":var_30", 900000),
        (try_end),
        (try_begin),
            (gt, ":var_29", 90000),
            (2076, 43, ":tar_enemy", 8, 1),
        (else_try),
            (2076, 43, ":tar_enemy", 9, 1),
        (try_end),
        (init_position, pos0),
        (position_copy_rotation, pos42, pos0),
        (position_copy_rotation, pos43, pos0),
        (position_move_z, pos43, 14, 1),
        (position_move_z, pos42, 14, 1),
        (try_begin),
            (gt, ":var_29", 0),
            (copy_position, pos41, pos43),
            (position_get_x, ":var_31", pos41),
            (position_get_y, ":var_32", pos41),
            (position_get_z, ":var_33", pos41),
            (position_get_x, ":var_34", pos42),
            (position_get_y, ":var_35", pos42),
            (position_get_z, ":var_36", pos42),
            (store_sub, ":var_37", ":var_33", ":var_36"),
            (store_sub, ":var_38", ":var_31", ":var_34"),
            (store_sub, ":var_39", ":var_32", ":var_35"),
            (store_mul, ":var_40", ":var_38", ":var_38"),
            (store_mul, ":var_41", ":var_39", ":var_39"),
            (store_add, ":var_42", ":var_40", ":var_41"),
            (store_mul, ":var_43", ":var_18", ":var_18"),
            (assign, ":var_44", 10),
            (convert_to_fixed_point, ":var_44"),
            (store_div, ":var_45", ":var_43", ":var_44"),
            (store_mul, ":var_46", ":var_45", ":var_45"),
            (store_mul, ":var_47", ":var_45", ":var_37"),
            (val_mul, ":var_47", 2),
            (store_sub, ":var_48", ":var_46", ":var_42"),
            (val_sub, ":var_48", ":var_47"),
            (try_begin),
                (gt, ":var_48", 0),
                (assign, ":var_1", 1),
                (convert_to_fixed_point, ":var_1"),
                (set_fixed_point_multiplier, 1),
                (store_sqrt, ":var_49", ":var_48"),
                (store_sub, ":var_50", ":var_45", ":var_49"),
                (val_sub, ":var_50", ":var_37"),
                (val_div, ":var_50", 100),
                (position_move_z, pos41, ":var_50", 1),
                (position_move_z, pos41, 4, 0),
                (set_fixed_point_multiplier, ":var_1"),
            (try_end),
            (copy_position, pos0, pos41),
            (position_get_z, ":var_1", pos42),
            (position_set_z, pos0, ":var_1"),
            (get_distance_between_positions, ":distance_abs", pos0, pos42),
            (position_transform_position_to_local, pos0, pos42, pos41),
            (position_get_z, ":var_37", pos0),
            (try_begin),
                (neg|ge, ":var_37", 0),
                (val_mul, ":var_37", 1),
            (try_end),
            (val_mul, ":var_37", 100),
            (val_div, ":var_37", ":distance_abs"),
            (store_atan, ":var_1", ":var_37"),
            (store_cos, ":var_1", ":var_1"),
            (store_mul, ":var_51", ":var_18", ":var_1"),
            (convert_from_fixed_point, ":var_51"),
            (copy_position, pos41, pos43),
            (position_transform_position_to_local, pos0, pos41, pos42),
            (position_get_x, ":var_38", pos0),
            (position_get_y, ":var_39", pos0),
            (try_begin),
                (eq, ":var_38", 0),
                (try_begin),
                    (eq, ":var_39", 0),
                    (assign, ":var_1", 0),
                (else_try),
                    (gt, ":var_39", 0),
                    (assign, ":var_1", 900000),
                (else_try),
                    (assign, ":var_1", 2700000),
                (try_end),
            (else_try),
                (convert_to_fixed_point, ":var_39"),
                (val_div, ":var_39", ":var_38"),
                (store_atan, ":var_1", ":var_39"),
                (try_begin),
                    (neg|ge, ":var_38", 0),
                    (val_add, ":var_1", 1800000),
                (try_end),
            (try_end),
            (val_add, ":var_1", 900000),
            (734, 41, ":var_1"),
            (store_mul, ":var_1", ":var_51", ":var_51"),
            (store_div, ":var_52", ":var_1", ":var_29"),
            (store_sub, ":var_53", ":var_52", 10000),
            (assign, ":var_54", ":distance_abs"),
            (convert_to_fixed_point, ":var_54"),
            (assign, ":var_1", ":var_54"),
            (convert_to_fixed_point, ":var_1"),
            (store_div, ":var_55", ":var_1", ":var_53"),
            (agent_get_position, pos2, ":tar_enemy"),
            (init_position, pos0),
            (position_copy_origin, pos2, pos41),
            (position_transform_position_to_local, pos2, pos41, pos2),
            (position_get_rotation_around_z, ":var_56", pos2),
            (convert_to_fixed_point, ":var_56"),
            (val_add, ":var_56", 900000),
            (val_add, ":var_56", ":var_30"),
            (try_begin),
                (store_cos, ":var_1", ":var_56"),
                (eq, ":var_1", 0),
                (assign, ":var_38", 0),
                (assign, ":var_39", 10000),
                (store_sqrt, ":var_1", ":var_52"),
                (val_add, ":var_39", ":var_1"),
                (try_begin),
                    (gt, ":var_56", 1800000),
                    (val_mul, ":var_39", 1),
                (try_end),
                (val_mul, ":var_39", ":var_55"),
                (convert_from_fixed_point, ":var_39"),
            (else_try),
                (store_tan, ":var_57", ":var_56"),
                (try_begin),
                    (neg|ge, ":var_57", 0),
                    (val_mul, ":var_57", 1),
                (try_end),
                (store_mul, ":var_58", ":var_57", ":var_57"),
                (convert_from_fixed_point, ":var_58"),
                (val_add, ":var_58", 10000),
                (assign, ":var_1", ":var_57"),
                (convert_to_fixed_point, ":var_1"),
                (store_div, ":var_59", ":var_1", ":var_58"),
                (val_mul, ":var_59", ":var_55"),
                (convert_from_fixed_point, ":var_59"),
                (assign, ":var_1", ":var_54"),
                (convert_to_fixed_point, ":var_1"),
                (store_div, ":var_60", ":var_1", ":var_58"),
                (store_mul, ":var_38", ":var_59", ":var_59"),
                (convert_from_fixed_point, ":var_38"),
                (store_mul, ":var_1", ":var_60", ":var_55"),
                (convert_from_fixed_point, ":var_1"),
                (val_add, ":var_38", ":var_1"),
                (store_sqrt, ":var_38", ":var_38"),
                (val_add, ":var_38", ":var_59"),
                (try_begin),
                    (gt, ":var_56", 900000),
                    (neg|ge, ":var_56", 2700000),
                    (val_mul, ":var_38", 1),
                (try_end),
                (store_mul, ":var_39", ":var_38", ":var_57"),
                (try_begin),
                    (neg|ge, ":var_28", 0),
                    (val_mul, ":var_39", 1),
                (try_end),
                (convert_from_fixed_point, ":var_39"),
            (try_end),
            (val_div, ":var_38", 100),
            (val_div, ":var_39", 100),
            (init_position, pos0),
            (position_set_x, pos0, ":var_38"),
            (position_set_y, pos0, ":var_39"),
            (position_transform_position_to_parent, pos41, pos41, pos0),
        (try_end),
        (try_begin),
            (neg|gt, ":var_29", 0),
            (copy_position, pos41, pos43),
        (try_end),
        (position_get_x, ":var_31", pos41),
        (position_get_y, ":var_32", pos41),
        (position_get_z, ":var_33", pos41),
        (position_get_x, ":var_34", pos42),
        (position_get_y, ":var_35", pos42),
        (position_get_z, ":var_36", pos42),
        (store_sub, ":var_37", ":var_33", ":var_36"),
        (store_sub, ":var_38", ":var_31", ":var_34"),
        (store_sub, ":var_39", ":var_32", ":var_35"),
        (store_mul, ":var_40", ":var_38", ":var_38"),
        (store_mul, ":var_41", ":var_39", ":var_39"),
        (store_add, ":var_42", ":var_40", ":var_41"),
        (store_mul, ":var_43", ":var_18", ":var_18"),
        (assign, ":var_44", 10),
        (convert_to_fixed_point, ":var_44"),
        (store_div, ":var_45", ":var_43", ":var_44"),
        (store_mul, ":var_46", ":var_45", ":var_45"),
        (store_mul, ":var_47", ":var_45", ":var_37"),
        (val_mul, ":var_47", 2),
        (store_sub, ":var_48", ":var_46", ":var_42"),
        (val_sub, ":var_48", ":var_47"),
        (try_begin),
            (gt, ":var_48", 0),
            (assign, ":var_1", 1),
            (convert_to_fixed_point, ":var_1"),
            (set_fixed_point_multiplier, 1),
            (store_sqrt, ":var_49", ":var_48"),
            (store_sub, ":var_50", ":var_45", ":var_49"),
            (val_sub, ":var_50", ":var_37"),
            (val_div, ":var_50", 100),
            (position_move_z, pos41, ":var_50", 1),
            (position_move_z, pos41, 4, 0),
            (set_fixed_point_multiplier, ":var_1"),
        (try_end),
        (position_transform_position_to_local, pos48, pos42, pos41),
        (position_get_y, ":var_39", pos48),
        (position_get_z, ":var_37", pos48),
        (try_begin),
            (eq, ":var_39", 0),
            (try_begin),
                (eq, ":var_37", 0),
                (assign, ":var_1", 0),
            (else_try),
                (ge, ":var_37", 0),
                (assign, ":var_1", 900000),
            (else_try),
                (assign, ":var_1", 2700000),
            (try_end),
        (else_try),
            (convert_to_fixed_point, ":var_37"),
            (val_div, ":var_37", ":var_39"),
            (store_atan, ":var_1", ":var_37"),
            (try_begin),
                (neg|ge, ":var_39", 0),
                (val_add, ":var_1", 1800000),
            (try_end),
        (try_end),
        (position_rotate_x_floating, pos42, ":var_1"),
        (position_transform_position_to_local, pos48, pos42, pos41),
        (position_get_y, ":var_39", pos48),
        (position_get_x, ":var_38", pos48),
        (try_begin),
            (eq, ":var_38", 0),
            (try_begin),
                (eq, ":var_39", 0),
                (assign, ":var_1", 0),
            (else_try),
                (ge, ":var_39", 0),
                (assign, ":var_1", 900000),
            (else_try),
                (assign, ":var_1", 2700000),
            (try_end),
        (else_try),
            (convert_to_fixed_point, ":var_39"),
            (val_div, ":var_39", ":var_38"),
            (store_atan, ":var_1", ":var_39"),
            (try_begin),
                (neg|ge, ":var_38", 0),
                (val_add, ":var_1", 1800000),
            (try_end),
        (try_end),
        (val_sub, ":var_1", 900000),
        (734, 42, ":var_1"),
    (try_end),
    (agent_get_slot, ":var_22", ":user", 172),
    (agent_get_slot, ":var_10", ":user", 174),
    (agent_get_slot, ":var_24", ":user", 171),
    (agent_get_slot, ":var_23", ":user", 173),
    (add_missile, ":user", 42, ":var_18", ":var_10", ":var_22", ":var_23", ":var_24"),
```

</details>

不要忘了```scripts```首行数字*+1*,转好后:

```python
fn_autoaim -1
 (行数) (代码部分)
```

3. 最后在战场触发器中实现自动射击:

<details> <summary>自瞄代码点我展开</summary>

```python
    (get_player_agent_no, ":user"),
    (agent_slot_eq,":user",1398,1), #开关为1,才会射击
    (agent_get_team, ":user_team", ":user"),
    (2076, 42, ":user", 9, 1),
    (assign,":max_range_calc",1000000),
    (assign,":close",-1),
    (try_for_agents,":enemies"), #筛选最近敌人
            (agent_is_alive, ":enemies"),
            (agent_is_human, ":enemies"),
            (agent_get_team, ":enemy_team", ":enemies"),
            (teams_are_enemies, ":user_team", ":enemy_team"),
            (2076, 0, ":enemies", 9, 1),
            (position_has_line_of_sight_to_position, pos42, pos0),
            (get_distance_between_positions, ":distance_abs", pos0, pos42),

            (lt, ":distance_abs", ":max_range_calc"),
            (assign, ":max_range_calc", ":distance_abs"),
            (assign,":close",":enemies"),
    (try_end),   
    (neq,":close",-1),
    (call_script,"script_fn_autoaim",":user",":close"), #调用
```

</details>

如何在战场触发器中添加这段代码,前面几篇有详细说明,此处不再赘述.

